:PROPERTIES:
:ID:       4401310f-222c-4031-8bd3-886830619480
:END:
#+STARTUP: overview
#+EXPORT_FILE_NAME: ~/repo/futurismo4/zk/hekireki.rst
#+OPTIONS: toc:t num:nil todo:nil pri:nil ^:nil author:nil *:t prop:nil
#+TITLE: âš¡My Emacs Config - éœ¹é‚ä¸€é–ƒ

Emacsã®å‘¼å¸å£±ãƒå‹, éœ¹é‚ä¸€é–ƒ.

packageã®ä¸¦ã³é †ã¯ [[https://github.com/hlissner/doom-emacs][Doom Emacs]] ã® [[https://github.com/hlissner/doom-emacs/blob/develop/docs/modules.org][Molule Index]] (ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †)ã«å¾“ã†.

ref: https://github.com/tsu-nera/hekireki

#+begin_src emacs-lisp :tangle yes
;;; $DOOMDIR/config.el -*- lexical-binding: t; -*-
#+end_src

* App

** Twitter
#+begin_src emacs-lisp :tangle yes
;; App
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; twittering-mode
;; ã“ã®è¨­å®šãŒãªã„ã¨èªè¨¼ãŒå¤±æ•—ã—ãŸ.
;; twittering-oauth-get-access-token: Failed to retrieve a request token
(add-hook! 'twittering-mode-hook
  (setq twittering-allow-insecure-server-cert t))

#+end_src

** eww
Emacsã®ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ©ã‚¦ã‚¶.

note: 
- ewwã‚’èµ·å‹•ã—ãŸã ã‘ã ã¨minibufferãªã®ã§C-gã§æ¶ˆãˆã¦ã—ã¾ã†ã®ã§å¤§ããC-x 1ã¨ã‹ã§å¤§ããã™ã‚‹.
- M-RETã§URLã‚’æ–°ã—ã„Bufferã§é–‹ã.
- Doom Emacsã ã¨C-c s o(online)ã§ã„ã‚ã„ã‚ã¨æ¤œç´¢ã§ãã‚‹(w/Chrome). helm-google-suggestçš„ãª.

#+begin_src emacs-lisp :tangle yes
(use-package! eww)
#+end_src

- ace-linkã‚’ã¤ã‹ã†ã¨ewwã®linkã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«é¸æŠã§ãã¦ä¾¿åˆ©.

#+begin_src emacs-lisp :tangle yes
(use-package! ace-link
  :config
  (eval-after-load 'eww '(define-key eww-mode-map "f" 'ace-link-eww))
  (ace-link-setup-default))
#+end_src

** org-web-tools
ewwã¨orgã‚’ä¾¿åˆ©ã«ã™ã‚‹ãƒ„ãƒ¼ãƒ«ç¾¤(https://github.com/alphapapa/org-web-tools).

#+begin_src emacs-lisp :tangle yes
(use-package! org-web-tools
  :after eww pocket-reader
  :config
  (map!
   :leader
   :prefix ("u" . "eww")
     "w" #'eww
     "o" #'eww-open-in-new-buffer
     "i" #'org-web-tools-insert-link-for-url
     "p" #'pocket-reader-add-link
))
#+end_src

** Pocket
ã‚ã¨ã§èª­ã‚€ã‚µãƒ¼ãƒ“ã‚¹.

#+begin_src emacs-lisp :tangle yes
(global-set-key (kbd "C-x w p") 'pocket-reader)
(use-package! pocket-reader
  :config
  (setq pocket-reader-open-url-default-function #'eww)
  (setq pocket-reader-pop-to-url-default-function #'eww)
)
#+end_src

** RSS(Elfeed)

#+begin_src emacs-lisp :tangle yes
;; elfeed
(global-set-key (kbd "C-x w w") 'elfeed)
(use-package! elfeed
  :config
  (setq elfeed-feeds
        '(
          ("https://yuchrszk.blogspot.com/feeds/posts/default" blog) ; ãƒ‘ãƒ¬ã‚ªãªç”·
          ("https://www.youtube.com/feeds/videos.xml?channel_id=UCFo4kqllbcQ4nV83WCyraiw" youtube) ; ä¸­ç”°æ•¦å½¦
          ("https://www.youtube.com/feeds/videos.xml?channel_id=UCFdBehO71GQaIom4WfVeGSw" youtube) ;ãƒ¡ãƒ³ã‚¿ãƒªã‚¹ãƒˆDaiGo
          ("https://www.youtube.com/feeds/videos.xml?playlist_id=PL3N_SB4Wr_S2cGYuI02bdb4UN9XTZRNDu" youtube) ; ä¸æ²¢ã®æµå„€
          ))
  (setq-default elfeed-search-filter "@1-week-ago +unread ")
  (defun elfeed-search-format-date (date)
    (format-time-string "%Y-%m-%d %H:%M" (seconds-to-time date)))
  )
#+end_src

* Checkers
#+begin_src emacs-lisp :tangle yes
;; Checkers
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#+end_src

* Completion
#+begin_src emacs-lisp :tangle yes
;; Completion
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
(use-package! avy
  :bind
  ("M-g c" . avy-goto-char) ;; doom ã® keybind ä¸Šæ›¸ã.
  ("M-g g" . avy-goto-line) ;; doom ã® keybind ä¸Šæ›¸ã.
  ("M-g s". avy-goto-word-1))

;; ã†ã¾ãå‹•ã‹ãªã„ã®ã§å°å° doom ã¨ã®ç›¸æ€§ãŒæ‚ªã„ã®ã‹ã‚‚.
;; ã²ã¨ã¾ãš migemo ã—ãŸã„ã¨ãã¯ isearch ã§å¯¾å¿œ.
;; (use-package! avy-migemo
;;  :after migemo
;;  :bind
;;  ("M-g m m" . avy-migemo-mode)
;;  ("M-g c" . avy-migemo-goto-char-timer) ;; doom ã® keybind ä¸Šæ›¸ã.
;;  :config
;;  (avy-migemo-mode 1)
;;  (setq avy-timeout-seconds nil))

(use-package! swiper
  :bind
  ;; ("C-s" . swiper) migemo ã¨ã†ã¾ãé€£æºã—ãªã„ã®ã§ isearch ç½®ãæ›ãˆã‚’ä¿ç•™. C-c s s ã§ swiper èµ·å‹•.
  :config
  (ivy-mode 1))

;; avy-migemo-e.g.swiper ã ã‘ãƒã‚¯ã‚‹
;; https://github.com/abo-abo/swiper/issues/2249
;;(after! avy-migemo
;;  (require 'avy-migemo-e.g.swiper))

;; org-roam ã® completion-at-point ãŒå‹•ä½œã—ãªã„ã®ã¯ã“ã„ã¤ã‹ãª...
;; (add-hook! 'org-mode-hook (company-mode -1))
;; company ã¯ãªã«ã’ã«ä½¿ã„ãã†ã ã‹ã‚‰ãªï¼ŒTAB ã§ã®ã¿è£œå®Œç™ºå‹•ã•ã›ã‚‹ã‹.
(setq company-idle-delay nil)
(global-set-key (kbd "TAB") #'company-indent-or-complete-common)
#+end_src

* Config
#+begin_src emacs-lisp :tangle yes
;; Config
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; memo:
;; use-package! ã¯:defer, :hook, :commands, or :after ãŒçœç•¥ã•ã‚Œã‚‹ã¨èµ·å‹•æ™‚ã« load ã•ã‚Œã‚‹.
;; after! ã¯ package ãŒ load ã•ã‚ŒãŸã¨ãã«è©•ä¾¡ã•ã‚Œã‚‹.
;; add-hook! ã¯ mode æœ‰åŠ¹åŒ–ã®ã¨ã. setq-hook!ã¯ equivalent.
;; ã©ã‚Œã‚’ä½¿ã†ã‹ã®æ­£è§£ã¯ãªã„ãŒã™ã¹ã¦ use-package!ã ã¨èµ·å‹•ãŒé…ããªã‚‹ã®ã§
;; å ´åˆã«ã‚ˆã£ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã›ã‚ˆï¼Œã¨ã®ã“ã¨.
;; https://github.com/hlissner/doom-emacs/blob/develop/docs/getting_started.org#configuring-packages
;;
;; doom specific config
;; (setq user-full-name "John Doe"
;;      user-mail-address "john@doe.com")
(setq confirm-kill-emacs nil) ; çµ‚äº†æ™‚ã®ç¢ºèªã¯ã—ãªã„.

;; ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã§ Emacs èµ·å‹•
;; ãƒ–ãƒ©ã‚¦ã‚¶ã¨ä¸¦ã¹ã¦è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒå¤šããªã£ãŸã®ã§ã„ã£ãŸã‚“ãƒã‚¹ã‚¯
;; (add-to-list 'initial-frame-alist '(fullscreen . maximized))

;; This is to use pdf-tools instead of doc-viewer
(use-package! pdf-tools
  :config
  (pdf-tools-install)
  ;; This means that pdfs are fitted to width by default when you open them
  (setq-default pdf-view-display-size 'fit-width)
  :custom
  (pdf-annot-activate-created-annotations t "automatically annotate highlights"))
#+end_src
* Editor
#+begin_src emacs-lisp :tangle yes
;; Editor
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; è‹±æ•°å­—ã¨æ—¥æœ¬èªã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’ã„ã‚Œã‚‹.
(use-package! pangu-spacing
  :config
  (global-pangu-spacing-mode 1)
  ;; ä¿å­˜æ™‚ã«è‡ªå‹•çš„ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã‚‹ã®ã‚’æŠ‘æ­¢.ã‚ãã¾ã§å…¥åŠ›æ™‚ã«ã—ã¦ãŠã.
  (setq pangu-spacing-real-insert-separtor nil))

;; è¨˜å·ã®å‰å¾Œã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã‚‹.
(use-package! electric-operator)
#+end_src

* Emacs
#+begin_src emacs-lisp :tangle yes
;; Emacs
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
#+end_src

** ace-window

- 3ã¤ä»¥ä¸Šã®windowã®é¸æŠãŒç•ªå·ã§ã§ãã‚‹. defaultã§C-x oã‚’ä¸Šæ›¸ãã—ã¦ã‚‹?
- C-u C-x o ã ã¨windowã‚’swapã§ãã‚‹(ace-swap-window).

* Email
#+begin_src emacs-lisp :tangle yes
;; Email
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#+end_src

* Input

#+begin_src emacs-lisp :tangle yes
;; Input
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
(set-language-environment "Japanese")
(prefer-coding-system 'utf-8)
(set-default 'buffer-filecoding-system 'utf-8)
(use-package! fcitx
  :config
  (setq fcitx-remote-command "fcitx5-remote")
  (fcitx-aggressive-setup)
  ;; Linux ãªã‚‰ t ãŒæ¨å¥¨ã•ã‚Œã‚‹ã‚‚ã®ã®ã€fcitx5 ã«ã¯æœªå¯¾å¿œãªãŸã‚ã“ã“ã¯ nil
  (setq fcitx-use-dbus nil))

;; migemo
(use-package! migemo
  :config
  (setq migemo-command "cmigemo")
  (setq migemo-options '("-q" "--emacs" "-i" "\a"))
  (setq migemo-dictionary "/usr/share/migemo/utf-8/migemo-dict")
  (setq migemo-user-dictionary nil)
  (setq migemo-regex-dictionary nil)
  (setq migemo-coding-system 'utf-8-unix)
  (migemo-init))
#+end_src

* Lang
#+begin_src emacs-lisp :tangle yes
#+end_src

* OS
#+begin_src emacs-lisp :tangle yes
;; OS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


#+end_src

* Org mode
#+begin_src emacs-lisp :tangle yes
;; Org mode
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; https://github.com/hlissner/doom-emacs/blob/develop/modules/lang/org/README.org
;; https://github.com/tsu-nera/dotfiles/blob/master/.emacs.d/inits/50_org-mode.org

;; ã‚¹ãƒãƒ›ã¨ã®å…±æœ‰ã®ãŸã‚, github ã‚’ clone ã—ãŸã‚‚ã®ã‚’ Dropbox ã«ç½®ã„ã¦$HOME ã« symlink ã—ã¦ã„ã‚‹.
(after! org
  (setq org-directory "~/keido")
  (setq org-default-notes-file "gtd/gtd_projects.org")

  (setq org-return-follows-link t) ;; Enter ã§ãƒªãƒ³ã‚¯å…ˆã¸ã‚¸ãƒ£ãƒ³ãƒ—
  (setq org-use-speed-commands t)  ;; bullet ã«ã‚«ãƒ¼ã‚½ãƒ«ãŒã‚ã‚‹ã¨é«˜é€Ÿç§»å‹•
  (setq org-hide-emphasis-markers t) ;; * ã‚’æ¶ˆã—ã¦è¡¨ç¤º.

  (setq org-footnote-section "Notes") ;; defaultã§ã¯Footnotesãªã®ã§å¤‰ãˆã‚‹.
  (setq org-footnote-auto-adjust t)

  ;; M-RET ã®æŒ™å‹•ã®èª¿æ•´
  ;; t ã ã¨ subtree ã®æœ€çµ‚è¡Œã« heading ã‚’æŒ¿å…¥, nil ã ã¨ current point ã«æŒ¿å…¥
  ;; ãªãŠï¼ŒC-RET ã ã¨ subtree ã®æœ€çµ‚è¡Œã«æŒ¿å…¥ã•ã‚Œ, C-S-RET ã ã¨æ‰‹å‰ã«æŒ¿å…¥ã•ã‚Œã‚‹.
  (setq org-insert-heading-respect-content nil)

  (setq org-startup-indented t)
  (setq org-indent-mode-turns-on-hiding-stars nil)

  (setq org-startup-folded 'show2levels);; è¦‹å‡ºã—ã®éšå±¤æŒ‡å®š
  (setq org-startup-truncated nil) ;; é•·ã„æ–‡ã¯æŠ˜ã‚Šè¿”ã™.

  ;; org-babel ã®ã‚½ãƒ¼ã‚¹ã‚’ã‚­ãƒ¬ã‚¤ã«è¡¨ç¤º.
  (setq org-src-fontify-natively t)
  (setq org-fontify-whole-heading-line t)

  ;; electric-indent ã¯ org-mode ã§èª¤ä½œå‹•ã®å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã®ã“ã¨
  ;; ãŸã¾ã«ã„ããªã‚Š org-mode ã® tree æ§‹é€ ãŒå£Šã‚Œã‚‹ã‹ã‚‰ï¼Œã¨ã‚Šã‚ãˆãšè¨­å®šã—ã¦ãŠã.
  ;; ã“ã®è¨­å®šã®åŠ¹æœãŒä»¥ä¸‹ã®è¨˜äº‹ã§ gif ã§ã‚ã‚‹.
  ;; https://www.philnewton.net/blog/electric-indent-with-org-mode/
  (add-hook! org-mode (electric-indent-local-mode -1))

  ;; org-agenda
  (setq org-refile-targets '((org-agenda-files :maxlevel . 3)))
  (setq org-agenda-time-leading-zero t) ;; æ™‚é–“è¡¨ç¤ºãŒ 1 æ¡ã®æ™‚, 0 ã‚’ã¤ã‘ã‚‹
  (setq calendar-holidays nil) ;; ç¥æ—¥ã‚’åˆ©ç”¨ã—ãªã„.
  (setq org-log-done 'time);; å¤‰æ›´æ™‚ã®çµ‚äº†æ™‚åˆ»è¨˜éŒ².

  ;; ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã¯ DONE ã«ãªã£ã¦ã„ã‚Œã°è¡¨ç¤ºã™ã‚‹
  (setq org-agenda-skip-deadline-if-done nil)
  (setq org-agenda-skip-scheduled-if-done nil)

  (setq org-agenda-include-inactive-timestamps t) ;; default ã§ logbook ã‚’è¡¨ç¤º
  (setq org-agenda-start-with-log-mode t) ;; ;; default ã§ æ™‚é–“ã‚’è¡¨ç¤º

  ;; org-agenda speedup tips
  ;; https://orgmode.org/worg/agenda-optimization.html

  ;; ä½•ã§ã‚‚ã‹ã‚“ã§ã‚‚ agenda ã™ã‚‹ã¨æ€ã„ã®ã§å³é¸.
  (setq org-agenda-files '("~/keido/notes/gtd/gtd_projects.org"
                           "~/keido/notes/journals/daily"))

  ;; æœŸé–“ã‚’é™å®š
  (setq org-agenda-span 30)
                                        ; Inhibit the dimming of blocked tasks:
  (setq org-agenda-dim-blocked-tasks nil)
  ;; Inhibit agenda files startup options:
  (setq org-agenda-inhibit-startup nil)
  ;; Disable tag inheritance in agenda:
  (setq org-agenda-use-tag-inheritance nil)

  ;; org-capture
  ;; https://orgmode.org/manual/Capture-templates.html
  (defun my/create-timestamped-org-file (path)
    (expand-file-name (format "%s.org" (format-time-string "%Y%m%d%H%M%S")) path))
  (defun my/create-date-org-file (path)
    (expand-file-name (format "%s.org" (format-time-string "%Y-%m-%d")) path))

  (defconst my/captured-notes-file "~/keido/inbox/inbox.org")

  (setq org-capture-templates
        '(("i" "ğŸ“¥ Inbox" entry
           (file "~/keido/inbox/inbox.org") "* %?\nCaptured On: %U\n"
           :klll-buffer t)
          ("L" "ğŸ“¥ browser" entry
           (file "~/keido/inbox/inbox.org")
           "* %?\nSource: [[%:link][%:description]]\nCaptured On: %U\n"
           :klll-buffer t)
          ("p" "ğŸ“¥ browser(quote)" entry
           (file "~/keido/inbox/inbox.org")
           "* %?\nSource: [[%:link][%:description]]\nCaptured On: %U\n%i\n"
           :klll-buffer t)
          ("c" "â˜‘ Planning" plain
           (file+headline (lambda () (my/create-date-org-file "~/keido/notes/journals/daily"))
                          "Planning")
           "%?"
           :unnarrowed t
           :kill-buffer t)
          ("t" "ğŸ¤” Thought" plain
           (file+headline (lambda () (my/create-date-org-file "~/keido/notes/journals/daily"))
                          "Thoughts")
           "%?"
           :empty-lines 1
           :unnarrowed t
           :kill-buffer t)
          ("T" "ğŸ¤” Thought+Ref" plain
           (file+headline (lambda () (my/create-date-org-file "~/keido/notes/journals/daily"))
                          "Thoughts")
           "%?\n%a"
           :empty-lines 1
           :unnarrowed t
           :kill-buffer t)
          ("j" "ğŸ–Š Journal" plain
           (file (lambda () (my/create-date-org-file "~/keido/notes/journals/daily")))
           "%?"
           :empty-lines 1
           :unnarrowed t
           :kill-buffer t)
          ("J" "ğŸ–Š Journal+Ref" plain
           (file (lambda () (my/create-date-org-file "~/keido/notes/journals/daily")))
           "%?\n%a"
           :empty-lines 1
           :unnarrowed t
           :kill-buffer t)
          ("z" "ğŸ’¡ Zettelkasten" plain
           (file (lambda () (my/create-timestamped-org-file "~/keido/notes/zk")))
           "#+TITLE:ğŸ’¡%?\n")
          ("w" "ğŸ“ Wiki" plain
           (file (lambda () (my/create-timestamped-org-file "~/keido/notes/wiki")))
           "#+EXPORT_FILE_NAME: ~/repo/futurismo4/wiki/xxx.rst
,#+OPTIONS: toc:t num:nil todo:nil pri:nil ^:nil author:nil *:t prop:nil
,#+TITLE:ğŸ“%?\n")
          ))

  ;; org-babel
  ;; è©•ä¾¡ã§ã„ã¡ã„ã¡è³ªå•ã•ã‚Œãªã„ã‚ˆã†ã«.
  (setq org-confirm-babel-evaluate nil)
  ;; org-babel ã§ å®Ÿè¡Œã—ãŸè¨€èªã‚’æ›¸ã. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ emacs-lisp ã ã‘.
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((lisp . t)
     (shell . t)))
  )

;; org-mode ã§ timestamp ã®ã¿ã‚’æŒ¿å…¥ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°(hh:mm)
(after! org
  (defun my/insert-timestamp ()
    "Insert time stamp."
    (interactive)
    (insert (format-time-string "%H:%M")))
  (map! :map org-mode-map "C-c C-." #'my/insert-timestamp))

;; +pretty(org-superstar-mode)é–¢é€£
;;; Titles and Sections
;; hide #+TITLE:
;; (setq org-hidden-keywords '(title))
;; set basic title font
;; (set-face-attribute 'org-level-8 nil :weight 'bold :inherit 'default)
;; Low levels are unimportant => no scaling
;; (set-face-attribute 'org-level-7 nil :inherit 'org-level-8)
;; (set-face-attribute 'org-level-6 nil :inherit 'org-level-8)
;; (set-face-attribute 'org-level-5 nil :inherit 'org-level-8)
;; (set-face-attribute 'org-level-4 nil :inherit 'org-level-8)
;; Top ones get scaled the same as in LaTeX (\large, \Large, \LARGE)
;; (set-face-attribute 'org-level-3 nil :inherit 'org-level-8 :height 1.2) ;\large
;; (set-face-attribute 'org-level-2 nil :inherit 'org-level-8 :height 1.44) ;\Large
;; (set-face-attribute 'org-level-1 nil :inherit 'org-level-8 :height 1.728) ;\LARGE
;; Only use the first 4 styles and do not cycle.
(setq org-cycle-level-faces nil)
(setq org-n-level-faces 4)
;; Document Title, (\huge)
;; (set-face-attribute 'org-document-title nil
;;                    :height 2.074
;;                    :foreground 'unspecified
;;                    :inherit 'org-level-8)

;; (with-eval-after-load 'org-superstar
;;  (set-face-attribute 'org-superstar-item nil :height 1.2)
;;  (set-face-attribute 'org-superstar-header-bullet nil :height 1.2)
;;  (set-face-attribute 'org-superstar-leading nil :height 1.3))
;; Set different bullets, with one getting a terminal fallback.
(setq org-superstar-headline-bullets-list '("â– " "â—†" "â—" "â–·"))
;; (setq org-superstar-special-todo-items t)

;; Stop cycling bullets to emphasize hierarchy of headlines.
(setq org-superstar-cycle-headline-bullets nil)
;; Hide away leading stars on terminal.
;; (setq org-superstar-leading-fallback ?\s)
(setq inhibit-compacting-font-caches t)

;; èª­æ›¸ã®ãŸã‚ã®ãƒãƒ¼ã‚«ãƒ¼ï¼ˆä»®ï¼‰
;; ã‚ã¨ã§ã¡ã‚ƒã‚“ã¨æ¤œè¨ã¨æœé®®ã—ã‚ˆã†.
;; (setq org-emphasis-alist
;;   '(("*" bold)
;;     ("/" italic)
;;     ("_" underline))
;;     ("=" (:background "red" :foreground "white")) ;; æ›¸ãæ‰‹ã®ä¸»å¼µ
;;     ("~" (:background "blue" :foreground "white")) cddddd;; æ ¹æ‹ 
;;     ("+" (:background "green" :foreground "black")))) ;; è‡ªåˆ†ã®è€ƒãˆ

;; org-clock é–¢é€£ ä½¿ã‚ãªã„ã®ã§ã„ã£ãŸã‚“ãƒã‚¹ã‚¯ã ãŒä½¿ã„ã“ãªã—ãŸã„ã®ã§æ¶ˆã•ãªã„.
;; (require 'org-toggl)
;; (setq toggl-auth-token "xxx")
;; (setq org-toggl-inherit-toggl-properties nil)
;; (org-toggl-integration-mode)

#+end_src

** ox-hugo

Org-modeã§æ›¸ã„ãŸãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’Hugoã«ã‚ã£ãŸMarkdownå½¢å¼ã«å¤‰æ›ã™ã‚‹.

ãƒ–ãƒ­ã‚°Futurismoã¯Org-modeã§åŸ·ç­†ã—ã¦ã“ã‚Œã‚’åˆ©ç”¨ã—ã¦Markdownã«å¤‰æ›ã—ã¦ã„ã‚‹.

#+begin_src emacs-lisp :tangle yes
(use-package! ox-hugo
  :after 'ox)
#+end_src

** ox-rst

Org-modeã§æ›¸ã„ãŸWikiç”¨ã®ãƒšãƒ¼ã‚¸ã‚’Sphinxã§å…¬é–‹ã™ã‚‹ãŸã‚ã«reSTå½¢å¼ã«å¤‰æ›ã™ã‚‹.

ãƒªãƒ³ã‚¯å½¢å¼ãŒã†ã¾ãå¤‰æ›ã§ããªã„ã®ã§ã‘ã£ã“ã†å¼·å¼•ã«å¤‰æ›ã—ã¦ã„ã‚‹(ã‚‚ã†å°‘ã—ã†ã¾ãæ”¹å–„ã—ãŸã„).

#+begin_src emacs-lisp :tangle yes
(use-package! ox-rst
  :after 'ox)

(after! ox
  (defun my/rst-to-sphinx-link-format (text backend info)
    (when (and (org-export-derived-backend-p backend 'rst) (not (search "<http" text)))
      (replace-regexp-in-string "\\(\\.org>`_\\)" ">`" (concat ":doc:" text) nil nil 1)))
  (add-to-list 'org-export-filter-link-functions
               'my/rst-to-sphinx-link-format))
#+end_src

** Org-roam

Zettelkasten Methodã®Org-roamå®Ÿè£….

#+begin_src emacs-lisp :tangle yes
;; org-roam
(setq org-roam-directory (file-truename "~/keido/notes"))
(setq org-roam-db-location (file-truename "~/keido/db/org-roam.db"))

(use-package! org-roam
  :after org
  :init
  (setq org-roam-v2-ack t)
  (map!
        :leader
        :prefix ("r" . "org-roam")
        "f" #'org-roam-node-find
        "i" #'org-roam-node-insert
        "l" #'org-roam-buffer-toggle
        "t" #'org-roam-tag-add
        "T" #'org-roam-tag-remove
        "a" #'org-roam-alias-add
        "A" #'org-roam-alias-remove
        "r" #'org-roam-ref-add
        "R" #'org-roam-ref-remove
        "o" #'org-id-get-create
        "s" #'org-roam-db-sync
        "u" #'org-roam-update-org-id-locations
        )
  :custom
  ;; ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ ID ã«ã™ã‚‹.
  (org-roam-capture-templates
   '(("d" "default" plain "%?"
      :target (file+head "%<%Y%m%d%H%M%S>.org"
                         "#+title: ${title}\n")
      :unnarrowed t)
     ("z" "ğŸ“ Zettelkasten" plain "%?"
      :target (file+head "zk/%<%Y%m%d%H%M%S>.org"
                         "#+title:ğŸ“${title}\n")
      :unnarrowed t)
     ("w" "ğŸ“ Wiki" plain "%?"
      :target (file+head "wiki/%<%Y%m%d%H%M%S>.org"
                         "#+title:ğŸ“${title}\n")
      :unnarrowed t)
     ("f" "ğŸ¦Š Darkfox" plain "%?"
      :target (file+head "darkfox/%<%Y%m%d%H%M%S>.org"
                         "#+title:ğŸ¦Š${title}\n")
      :unnarrowed t)
     ("b" "ğŸ“š Book" plain
      "%?

- title: %^{title}
- authors: %^{author}
- date: %^{date}
- publisher: %^{publisher}
- url: http://www.amazon.co.jp/dp/%^{isbn}
"
      :target (file+head "wiki/%<%Y%m%d%H%M%S>.org"
                         "#+title:ğŸ“š${title} - ${author}(${date})\n")
      :unnarrowed t)
     ("t" "ğŸ¤ Talk" plain
      "%?

- title: %^{title}
- editor: %^{editor}
- date: %^{date}
- url: %^{url}
"
      :target (file+head "wiki/%<%Y%m%d%H%M%S>.org"
                         "#+title:ğŸ¤${title} - ${editor}(${date})\n")
      :unnarrowed t)
     ("o" "ğŸ’» Online" plain
      "%?

- title: %^{title}
- authors: %^{author}
- url: %^{url}
"
      :target (file+head "wiki/%<%Y%m%d%H%M%S>.org"
                         "#+title:ğŸ’»${title}\n")
      :unnarrowed t)))
  (org-roam-extract-new-file-path "%<%Y%m%d%H%M%S>.org")
  (org-roam-dailies-directory "journals/daily/")
  ;;        :map org-mode-map
  ;;        ("C-M-i"    . completion-at-point)
  ;;        :map org-roam-dailies-map
  ;;        ("Y" . org-roam-dailies-capture-yesterday)
  ;;        ("T" . org-roam-dailies-capture-tomorrow))
  :bind-keymap
  ("C-c r d" . org-roam-dailies-map)
  :config
  (setq org-roam-dailies-capture-templates
        '(("d" "default" item "%?"
           :if-new (file+head "%<%Y-%m-%d>.org" "#+Title: %<%Y-%m-%d>")
           :unnarrowed t)))

  (setq +org-roam-open-buffer-on-find-file nil)
  (require 'org-roam-dailies) ; Ensure the keymap is available
  (org-roam-db-autosync-mode))


(use-package! websocket
    :after org-roam)
(use-package! org-roam-ui
    :after org-roam ;; or :after org
;;         normally we'd recommend hooking orui after org-roam, but since org-roam does not have
;;         a hookable mode anymore, you're advised to pick something yourself
;;         if you don't care about startup time, use
    ;; :hook (after-init . org-roam-ui-mode)
    :config
    (setq org-roam-ui-sync-theme t
          org-roam-ui-follow t
          org-roam-ui-update-on-save t
          org-roam-ui-open-on-start t))

(use-package! org-roam-timestamps
   :after org-roam
   :config
   (org-roam-timestamps-mode)
   (setq org-roam-timestamps-remember-timestamps nil)
   (setq org-roam-timestamps-remember-timestamps nil))


;; ä»Šã©ãã®ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒŠãƒ¼çš„ãªç·šã‚’å‡ºã™.
;; Terminal Mode ã§ã¯ã¤ã‹ãˆãªã„ã®ã§ä¸€æ—¦ç„¡åŠ¹åŒ–ã™ã‚‹.
;; (require 'org-bars)
;; (add-hook! 'org-mode-hook #'org-bars-mode)

;; ç©ºç™½ãŒä¿å­˜æ™‚ã«å‰Šé™¤ã•ã‚Œã‚‹ã¨ bullet è¡¨ç¤ºãŒãŠã‹ã—ããªã‚‹.
;; ãªãŠ wl-bulter ã¯ doom emacs ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹.
(add-hook! 'org-mode-hook (ws-butler-mode -1))
#+end_src

*** org-publish(Org-roamã®ãƒãƒ¼ãƒˆã‚’ã‚µã‚¤ãƒˆã¸å…¬é–‹)

#+begin_src emacs-lisp :tangle yes
(setq org-publish-project-alist
      (list
       (list "fshort"
             :recursive t
             :base-directory "~/keido/notes/wiki"
             :publishing-directory "~/repo/futurismo4/fshort/content/notes"
             :publishing-function 'org-hugo-export-to-md)))
#+end_src


** bibtexé–¢é€£(Org-ref)

æ–‡çŒ®ç®¡ç†. Zoteroã¨é€£æºã—ã¦ï¼Œè«–æ–‡ã¨ã„ã†ã‚ˆã‚Šã¯æ›¸ç±ã‚„Youtubeå‹•ç”»ã‚„Webè¨˜äº‹ã®ãƒ¡ãƒ¢ã«åˆ©ç”¨.

- org-ref
- ivy-bibtex
  - ivyã®actionã¯ ivy-bibtexã§C-SPCã§é¸æŠ-> C-M-oã§actioné¸æŠå€™è£œã‚’å‡ºã—ï¼Œpã¨ã‹eã¨ã‹æŠ¼ã™.
- org-roam-bibtex

#+begin_src emacs-lisp :tangle yes
(use-package! org-ref
  :config
  (setq bibtex-completion-bibliography (list (file-truename "~/keido/references/zotLib.bib")))

  (setq bibtex-completion-additional-search-fields '(keywords))
  (setq bibtex-completion-display-formats
    '((online       . "${=has-pdf=:1}${=has-note=:1} ${=type=:6} ${year:4} ${author:24} ${title:*}")
      (book         . "${=has-pdf=:1}${=has-note=:1} ${=type=:6} ${year:4} ${author:24} ${title:*}")
      (video        . "${=has-pdf=:1}${=has-note=:1} ${=type=:6} ${year:4} ${editor:24} ${title:*}")
      (paper        . "${=has-pdf=:1}${=has-note=:1} ${=type=:6} ${year:4} ${author:24} ${title:*}")
      (t            . "${=has-pdf=:1}${=has-note=:1} ${=type=:6} ${year:4} ${author:24} ${title:*}")))
  (setq bibtex-completion-pdf-symbol "ğŸ““")
  (setq bibtex-completion-notes-symbol "ğŸ“")

  (setq bibtex-completion-pdf-field "file")
  ;; (setq bibtex-completion-pdf-open-function
  ;;	(lambda (fpath)
  ;;	  (call-process "open" nil 0 nil fpath)))

  ;; Create fields for Film type
  (add-to-list 'bibtex-biblatex-field-alist
               '(("video" "Video or Audio(like YouTube)")))

  (add-to-list 'bibtex-biblatex-entry-alist
               '("video" "A Video"
                 ("video", "title" "editor" "date" "url" "urldate" "abstract" "editortype")
                 nil
                 "keywords"))
  (bibtex-set-dialect 'biblatex))

(use-package! ivy-bibtex
  :after org-ref
  :init
  (map!
   :leader
   :prefix ("b" . "org-ref")
     "b" #'org-ref-bibtex-hydra/body
     "v" #'ivy-bibtex
     "c" #'org-ref-insert-cite-link
     "a" #'orb-note-actions
     "i" #'orb-insert-link)
  :config
  (setq ivy-re-builders-alist
        '((ivy-bibtex . ivy--regex-ignore-order)
          (t . ivy--regex-plus)))
  (setq ivy-bibtex-default-action #'ivy-bibtex-open-url-or-doi)
  (ivy-set-actions
   'ivy-bibtex
   '(("p" ivy-bibtex-open-any "Open PDF, URL, or DOI" ivy-bibtex-open-any)
     ("e" ivy-bibtex-edit-notes "Edit notes" ivy-bibtex-edit-notes)))
  )

(use-package! org-roam-protocol
  :after org-protocol)

(use-package! org-roam-bibtex
  :after org-roam ivy-bibtex
  :hook (org-mode . org-roam-bibtex-mode)
  :custom
  (orb-insert-interface 'ivy-bibtex)
  :config
    (setq orb-preformat-keywords '("author" "date" "url" "title" "isbn" "publisher" "urldate" "editor" "file"))
    (setq orb-process-file-keyword t)
    (setq orb-attached-file-extensions '("pdf")))
#+end_src

** Org-noter

PDFã®æ³¨é‡ˆã‚’ç®¡ç†ã™ã‚‹. [[https://github.com/weirdNox/org-noter][:link:weirdNox/org-noter]]

ã¯ã˜ã‚ã®èµ·å‹•ãŒã©ã†ã‚„ã‚Œã°ã„ã„ã®ã‹ãƒ¯ã‚«ãƒ©ãªã‹ã£ãŸ. 
ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²ã‚’æ®‹ã—ãŸã„å ´åˆã¯PDFã®Bufferã§ã¯ãªã, 
é©å½“ãªheadingä½œæˆã—ã¦M-x org-noterã‚’èµ·å‹•ã™ã‚‹ã¨PDFã‚’é¸æŠã§ãã‚‹.

M-x org-noter-create-skeltonã¨ã„ã†é–¢æ•°ãŒãƒ¤ã°ã„. [[https://youtu.be/lCc3UoQku-E?t=68][ğŸ”—Youtubeå‹•ç”»(1:08)]]
PDFã‹ã‚‰Outlineã‚’æŠœãå‡ºã—ã¦Org fileã«ç”Ÿæˆã—ã¦ï¼Œ
ã‚ã¨ã¯ãã®Org-fileã®Bulletã®ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç§»å‹•ã™ã‚‹ã¨PDFã®ã»ã†ã‚‚ã‚·ãƒ³ã‚¯ãƒ­ã—ã¦ç§»å‹•ã§ãã‚‹. 

å‡„ã™ãã¦ç¬‘ã£ãŸ:sweat_smile:

#+begin_src emacs-lisp :tangle yes
(use-package! org-noter
  :after (:any org pdf-view)
  :config
  (setq
   ;; I want to see the whole file
   org-noter-hide-other nil
   ;; Everything is relative to the main notes file
   org-noter-notes-search-path (list (file-truename "~/keido/notes/wiki/src"))
   ))
#+end_src

*** org-pdftools
org-noterã¨pdftoolsã‚’é€£æºã•ã›ã‚‹. 
pdftoolsã®annotationãŒorg-noterã®ç®¡ç†åŒ–ã«ãªã‚‹.

https://github.com/fuxialexander/org-pdftools

#+begin_src emacs-lisp :tangle yes
(use-package! org-pdftools
  :hook (org-mode . org-pdftools-setup-link))

(use-package! org-noter-pdftools
  :after org-noter
  :config
  ;; Add a function to ensure precise note is inserted
  (defun org-noter-pdftools-insert-precise-note (&optional toggle-no-questions)
    (interactive "P")
    (org-noter--with-valid-session
     (let ((org-noter-insert-note-no-questions (if toggle-no-questions
                                                   (not org-noter-insert-note-no-questions)
                                                 org-noter-insert-note-no-questions))
           (org-pdftools-use-isearch-link t)
           (org-pdftools-use-freestyle-annot t))
       (org-noter-insert-note (org-noter--get-precise-info)))))

  ;; fix https://github.com/weirdNox/org-noter/pull/93/commits/f8349ae7575e599f375de1be6be2d0d5de4e6cbf
  (defun org-noter-set-start-location (&optional arg)
    "When opening a session with this document, go to the current location.
With a prefix ARG, remove start location."
    (interactive "P")
    (org-noter--with-valid-session
     (let ((inhibit-read-only t)
           (ast (org-noter--parse-root))
           (location (org-noter--doc-approx-location (when (called-interactively-p 'any) 'interactive))))
       (with-current-buffer (org-noter--session-notes-buffer session)
         (org-with-wide-buffer
          (goto-char (org-element-property :begin ast))
          (if arg
              (org-entry-delete nil org-noter-property-note-location)
            (org-entry-put nil org-noter-property-note-location
                           (org-noter--pretty-print-location location))))))))
  (with-eval-after-load 'pdf-annot
    (add-hook 'pdf-annot-activate-handler-functions #'org-noter-pdftools-jump-to-note)))
#+end_src

* Term 
#+begin_src emacs-lisp :tangle yes
;; Term
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
#+end_src

* Tools
#+begin_src emacs-lisp :tangle yes
;; Tools
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
#+end_src

* UI

** Doom

#+begin_src emacs-lisp :tangle yes
;; UI
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; ã©ã†ã‚‚ãƒ•ã‚©ãƒ³ãƒˆãŒå¥‡æ•°ã ã¨ org-table ã®è¡¨ç¤ºãŒå´©ã‚Œã‚‹.
;; Source Han Code JP ã ã¨ãã‚‚ãã‚‚ org-table ã®è¡¨ç¤ºãŒå´©ã‚Œã‚‹.
;; terminal ã ã¨å¤§ä¸ˆå¤«ãªæ¨¡æ§˜.ãã‚‚ãã‚‚ Terminal ã¯ã“ã®è¨­å®šã§ã¯ãªãã¦ Terminal Emulator ã®è¨­å®šãŒãã.

;; (setq doom-font (font-spec :family "Source Han Code JP" :size 12 ))
(setq doom-font (font-spec :family "Ricty Diminished" :size 15))
;; doom-molokaiã‚„doom-monokai-classicã ã¨ewwã®è¡¨ç¤ºãŒã„ã¾ã„ã¡.
(setq doom-theme 'doom-monokai-pro)
(doom-themes-org-config)

;; counselã¨doom-modelineãŒç›¸æ€§æ‚ªã„ã‚ˆã†ãªã®ã§workspace nameè¡¨ç¤ºã®ãŸã‚ã«ã¯è¿½åŠ ã§è¨­å®š.
;; https://github.com/hlissner/doom-emacs/issues/314
(after! doom-modeline
  (setq doom-modeline-persp-name t))
#+end_src

** perfect-margin

ã„ã„æ„Ÿã˜ã«marginã‚’ã¨ã£ã¦ãã‚Œã‚‹ (https://github.com/mpwang/perfect-margin)

#+begin_src emacs-lisp :tangle yes
(use-package! perfect-margin
  :config
  (perfect-margin-mode 1))
#+end_src

** Others

#+begin_src emacs-lisp :tangle yes

(setq display-line-numbers-type t) ; è¡Œç•ªå·è¡¨ç¤º

;; less ã§ã®ãƒ•ã‚¡ã‚¤ãƒ«é–²è¦§ã«æ“ä½œæ€§ã‚’ä¼¼ã›ã‚‹ mode.
;; view-mode ã¯ emacs å†…è”µ. C-x C-r ã§ read-only-mode ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚ªãƒ¼ãƒ—ãƒ³
;; doom emacs ã ã¨ C-c t r ã§ read-only-mode ãŒèµ·å‹•ã™ã‚‹.
(add-hook! view-mode
  (setq view-read-only t)
  (define-key ctl-x-map "\C-q" 'view-mode) ;; assinged C-x C-q.

  ;; less ã£ã¼ã.
  (define-key view-mode-map (kbd "p") 'view-scroll-line-backward)
  (define-key view-mode-map (kbd "n") 'view-scroll-line-forward)
  ;; default ã® e ã§ã‚‚ã„ã„ã‘ã©ï¼Œmule æ™‚ä»£ã« v ã« bind ã•ã‚Œã¦ãŸã®ã§, emacs ã§ã‚‚ v ã« bind ã—ã¦ãŠã.
  (define-key view-mode-map (kbd "v") 'read-only-mode))

;; deft ã¯ Org-roam ã‚·ã‚¹ãƒ†ãƒ ã®æ¤œç´¢ã§æ´»èºã™ã‚‹
(use-package! deft
  :after org-roam
  :bind
  ("C-c r j" . deft) ;; Doom ã ã¨ C-c n d ã«ã‚‚ bind ã•ã‚Œã¦ã„ã‚‹.
  :config
  (setq deft-default-extension "org")
  (setq deft-directory org-roam-directory)
  (setq deft-recursive t)
  (setq deft-strip-summary-regexp ":PROPERTIES:\n\\(.+\n\\)+:END:\n")
  (setq deft-use-filename-as-title nil)
  (setq deft-auto-save-interval -1.0) ;; disable auto-save
  (add-to-list 'deft-extensions "tex")
  ;; (setq deft-use-filter-string-for-filename t)
  ;; (setq deft-org-mode-title-prefix t)
  ;;
  ;; deft ã§ org-roam ã® title ã‚’ parse ã™ã‚‹ãŸã‚ã® workaround
  ;; see: https://github.com/jrblevin/deft/issues/75
  (advice-add 'deft-parse-title :override
    (lambda (file contents)
      (if deft-use-filename-as-title
          (deft-base-filename file)
        (let* ((case-fold-search 't)
               (begin (string-match "title: " contents))
               (end-of-begin (match-end 0))
               (end (string-match "\n" contents begin)))
          (if begin
              (substring contents end-of-begin end)
            (format "%s" file)))))))
#+end_src

